ad_library {
    Automated tests for sol system

    @creation-date 2016-03-12
}

aa_register_case ssk_pos_kepler {
    Test ssk::pos_kepler proc
} {    
    
    aa_run_with_teardown \
        -rollback \
        -test_code {
            ns_log Notice "aa_register_case.14: Begin test"
            
            # Using test example values from github.com/soniakeys/aprx/aprx_test.go
            # each data set in list format date_j2000 date_utc x y z
            set data_larr(Mercury) [list 2392618.348888889 "A.D. 1838-Aug-31 20:22:24" \
                                        1.548823231869134E-01 -4.157913706888478E-01 -4.824480338511314E-02 \
                                        2394577.781967592 "A.D. 1844-Jan-12 06:46:02" \
                                        2.845999671248569E-01  1.525475400828178E-01 -1.483099302602067E-02 \
                                        2416010.781122685 "A.D. 1902-Sep-18 06:44:49"\
                                        -1.679963565729586E-02 -4.576309342838302E-01 -3.651816371962761E-02\
                                        2416942.849571759 "A.D. 1905-Apr-07 08:23:23"\
                                        -3.057944208423483E-01  1.712921868878150E-01  4.196705086931921E-02\
                                        2419270.121215278 "A.D. 1911-Aug-21 14:54:33"\
                                        8.959793854745271E-02 -4.442727573347598E-01 -4.440683136341977E-02\
                                        2422274.928819444 "A.D. 1919-Nov-12 10:17:30"\
                                        3.359777095653234E-01 -2.273036482374957E-01 -4.856338824532506E-02\
                                        2428739.750625000 "A.D. 1937-Jul-25 06:00:54"\
                                        -3.984637207263458E-01 -5.723749476376432E-02  3.142988788471642E-02\
                                        2431227.969537037 "A.D. 1944-May-17 11:16:08"\
                                        -3.976231155254906E-02 -4.680944034850698E-01 -3.363243182979548E-02\
                                        2436474.748576389 "A.D. 1958-Sep-28 05:57:57"\
                                        -3.402802298662789E-01  1.132219284397481E-01  4.031601711715327E-02\
                                        2449680.541712963 "A.D. 1994-Nov-24 01:00:04"\
                                        -3.870660019863127E-01 -1.592791286144737E-01  2.185822420363603E-02]
            set data_larr(Venus) [list 2392618.348888889 "A.D. 1838-Aug-31 20:22:24"\
                                      -3.653299965942847E-02  7.220146606762762E-01  1.167580190259101E-02\
                                      2394577.781967592 "A.D. 1844-Jan-12 06:46:02"\
                                      7.116861822264303E-01 -8.892562099156549E-02 -4.274655857351164E-02\
                                      2416010.781122685 "A.D. 1902-Sep-18 06:44:49"\
                                      -4.799522500869983E-01  5.426532189127753E-01  3.477620746701530E-02\
                                      2416942.849571759 "A.D. 1905-Apr-07 08:23:23"\
                                      -7.216457774076996E-01 -7.097494674151705E-02  4.064724203401868E-02\
                                      2419270.121215278 "A.D. 1911-Aug-21 14:54:33"\
                                      5.008825453605343E-01 -5.276259230426823E-01 -3.591089605425882E-02\
                                      2422274.928819444 "A.D. 1919-Nov-12 10:17:30"\
                                      4.415820902206893E-02  7.129077792913658E-01  7.327019640740323E-03\
                                      2428739.750625000 "A.D. 1937-Jul-25 06:00:54"\
                                      7.191562844637240E-01  5.918424151805801E-02 -4.090724293568024E-02\
                                      2431227.969537037 "A.D. 1944-May-17 11:16:08"\
                                      6.276487867033819E-01  3.639836853448694E-01 -3.101050574226510E-02\
                                      2436474.748576389 "A.D. 1958-Sep-28 05:57:57"\
                                      -6.585110628760721E-01  2.776437704195617E-01  4.183490014653859E-02\
                                      2449680.541712963 "A.D. 1994-Nov-24 01:00:04"\
                                      1.951946740289579E-01  7.008370344157071E-01 -1.840345267626935E-03]
            set data_larr(EMBary) [list 2392618.348888889 "A.D. 1838-Aug-31 20:22:24"\
                                       9.536922197251746E-01 -3.380488660467687E-01 -3.014707380466051E-04\
                                       2394577.781967592 "A.D. 1844-Jan-12 06:46:02"\
                                       -3.987461925062515E-01  9.076446840152066E-01  4.357849841555264E-04\
                                       2416010.781122685 "A.D. 1902-Sep-18 06:44:49"\
                                       9.971985508538384E-01 -6.895402077986681E-02  1.075861814597534E-04\
                                       2416942.849571759 "A.D. 1905-Apr-07 08:23:23"\
                                       -9.570195736818290E-01 -3.147350787745524E-01  1.034489421446561E-04\
                                       2419270.121215278 "A.D. 1911-Aug-21 14:54:33"\
                                       8.655795878977824E-01 -5.247017579043201E-01 -5.259044866273049E-05\
                                       2422274.928819444 "A.D. 1919-Nov-12 10:17:30"\
                                       6.404879462395888E-01  7.534365483372363E-01  3.008897962448555E-05\
                                       2428739.750625000 "A.D. 1937-Jul-25 06:00:54"\
                                       5.454464497393744E-01 -8.507353689588105E-01 -1.616816854036765E-06\
                                       2431227.969537037 "A.D. 1944-May-17 11:16:08"\
                                       -5.423552317226220E-01 -8.560568668131158E-01 -1.933804862163107E-04\
                                       2436474.748576389 "A.D. 1958-Sep-28 05:57:57"\
                                       1.003833069697188E+00  9.706459304040445E-02 -2.016958016501873E-04\
                                       2449680.541712963 "A.D. 1994-Nov-24 01:00:04"\
                                       4.690800099415641E-01  8.756972042038854E-01  8.161865980003442E-06]
            set data_larr(Mars) [list 2392618.348888889 "A.D. 1838-Aug-31 20:22:24"\
                                     1.090860401006707E-01  1.562358973572803E+00  2.975643982817535E-02\
                                     2394577.781967592 "A.D. 1844-Jan-12 06:46:02"\
                                     1.218826081046183E+00  7.502676110454020E-01 -1.486913516160252E-02\
                                     2416010.781122685 "A.D. 1902-Sep-18 06:44:49"\
                                     -3.695541805077162E-01  1.563906367650362E+00  4.175204181558848E-02\
                                     2416942.849571759 "A.D. 1905-Apr-07 08:23:23"\
                                     -1.332271099981464E+00 -8.775596329698978E-01  1.476212197802583E-02\
                                     2419270.121215278 "A.D. 1911-Aug-21 14:54:33"\
                                     1.388399998801639E+00  1.885875588701628E-01 -3.039580819535666E-02\
                                     2422274.928819444 "A.D. 1919-Nov-12 10:17:30"\
                                     -1.265934833617703E+00  1.059150065738351E+00  5.363502607332231E-02\
                                     2428739.750625000 "A.D. 1937-Jul-25 06:00:54"\
                                     1.420604585195199E-01 -1.431536381988052E+00 -3.352495798114563E-02\
                                     2431227.969537037 "A.D. 1944-May-17 11:16:08"\
                                     -1.433330240448434E+00  8.301047929290724E-01  5.295287459254058E-02\
                                     2436474.748576389 "A.D. 1958-Sep-28 05:57:57"\
                                     1.286825514081086E+00  6.306024116055990E-01 -1.874825149271610E-02\
                                     2449680.541712963 "A.D. 1994-Nov-24 01:00:04"\
                                     -4.675161880828237E-01  1.546024337700224E+00  4.370958467066259E-02]
            set data_arr(Jupiter) [list 2392618.348888889 "A.D. 1838-Aug-31 20:22:24"\
                                       -5.441594890769812E+00  2.344125614625184E-02  1.220569812351510E-01\
                                       2394577.781967592 "A.D. 1844-Jan-12 06:46:02"\
                                       4.624541721443121E+00 -1.859515118965659E+00 -9.638852591425372E-02\
                                       2416010.781122685 "A.D. 1902-Sep-18 06:44:49"\
                                       3.721794681176392E+00 -3.409821750810460E+00 -6.959131100823206E-02\
                                       2416942.849571759 "A.D. 1905-Apr-07 08:23:23"\
                                       3.693581055186907E+00  3.328710421532305E+00 -9.633070632223152E-02\
                                       2419270.121215278 "A.D. 1911-Aug-21 14:54:33"\
                                       -3.503334680730101E+00 -4.108950933641291E+00  9.538066545865474E-02\
                                       2422274.928819444 "A.D. 1919-Nov-12 10:17:30"\
                                       -3.225275339314337E+00  4.183597359537123E+00  5.530617855393209E-02\
                                       2428739.750625000 "A.D. 1937-Jul-25 06:00:54"\
                                       2.101436251040202E+00 -4.699407238587018E+00 -2.784587296531547E-02\
                                       2431227.969537037 "A.D. 1944-May-17 11:16:08"\
                                       -4.665998468808048E+00  2.656938218927166E+00  9.366837928574059E-02\
                                       2436474.748576389 "A.D. 1958-Sep-28 05:57:57"\
                                       -4.163222842568572E+00 -3.468734070380494E+00  1.074867445851786E-01\
                                       2449680.541712963 "A.D. 1994-Nov-24 01:00:04"\
                                       -3.030361522669744E+00 -4.449670470465644E+00  8.629483738267320E-02]
            set data_arr(Saturn) [list 2392618.348888889 "A.D. 1838-Aug-31 20:22:24"\
                                      -4.823147454253415E+00 -8.726558606601632E+00  3.455209247904795E-01\
                                      2394577.781967592 "A.D. 1844-Jan-12 06:46:02"\
                                      5.019728245772046E+00 -8.649371706693374E+00 -4.554231209744085E-02\
                                      2416010.781122685 "A.D. 1902-Sep-18 06:44:49"\
                                      4.656012471567380E+00 -8.860708914019893E+00 -2.860156371513501E-02\
                                      2416942.849571759 "A.D. 1905-Apr-07 08:23:23"\
                                      8.189790300326463E+00 -5.430501359032882E+00 -2.291900131797807E-01\
                                      2419270.121215278 "A.D. 1911-Aug-21 14:54:33"\
                                      6.474913424886942E+00  6.484582942235308E+00 -3.710111313265292E-01\
                                      2422274.928819444 "A.D. 1919-Nov-12 10:17:30"\
                                      -8.446187387409754E+00  3.828236300053229E+00  2.676673549142415E-01\
                                      2428739.750625000 "A.D. 1937-Jul-25 06:00:54"\
                                      9.524005499885051E+00  8.454004867729607E-02 -3.793813825070869E-01\
                                      2431227.969537037 "A.D. 1944-May-17 11:16:08"\
                                      6.011331079689455E-02  9.022761040900134E+00 -1.603194227712763E-01\
                                      2436474.748576389 "A.D. 1958-Sep-28 05:57:57"\
                                      -6.619106674614628E-01 -1.003091381911697E+01  2.018650986245450E-01\
                                      2449680.541712963 "A.D. 1994-Nov-24 01:00:04"\
                                      9.200091084222676E+00 -3.023053830788716E+00 -3.130816868670911E-01]
            set data_larr(Uranus) [list 2392618.348888889 "A.D. 1838-Aug-31 20:22:24"\
                                       1.917799110041351E+01 -5.970658167159124E+00 -2.721287176383819E-01\
                                       2394577.781967592 "A.D. 1844-Jan-12 06:46:02"\
                                       2.002832756674176E+01  1.280754164602191E+00 -2.559776236763418E-01\
                                       2416010.781122685 "A.D. 1902-Sep-18 06:44:49"\
                                       -2.734159275991967E+00 -1.897225145605318E+01 -3.515659586549819E-02\
                                       2416942.849571759 "A.D. 1905-Apr-07 08:23:23"\
                                       8.943173754671779E-01 -1.931869782611635E+01 -8.359493202760979E-02\
                                       2419270.121215278 "A.D. 1911-Aug-21 14:54:33"\
                                       9.551621668067813E+00 -1.725899016125577E+01 -1.884074566260213E-01\
                                       2422274.928819444 "A.D. 1919-Nov-12 10:17:30"\
                                       1.764597883337821E+01 -9.504747020569660E+00 -2.646733651936143E-01\
                                       2428739.750625000 "A.D. 1937-Jul-25 06:00:54"\
                                       1.480207581789714E+01  1.306036505084077E+01 -1.436658414626658E-01\
                                       2431227.969537037 "A.D. 1944-May-17 11:16:08"\
                                       6.754992153857762E+00  1.810855322795565E+01 -2.036880565760164E-02\
                                       2436474.748576389 "A.D. 1958-Sep-28 05:57:57"\
                                       -1.263933082315303E+01  1.344872456995551E+01  2.140643842657925E-01\
                                       2449680.541712963 "A.D. 1994-Nov-24 01:00:04"\
                                       8.591848173771956E+00 -1.770284937874579E+01 -1.770844029249434E-01]
            set data_list(Neptune) [list 2392618.348888889 "A.D. 1838-Aug-31 20:22:24"\
                                        1.991937742531429E+01 -2.254740327155060E+01  5.395459555029242E-03\
                                        2394577.781967592 "A.D. 1844-Jan-12 06:46:02"\
                                        2.404200074941640E+01 -1.799856549094060E+01 -1.832280707557830E-01\
                                        2416010.781122685 "A.D. 1902-Sep-18 06:44:49"\
                                        -1.607119215727208E+00  2.984756023304759E+01 -5.775492690188169E-01\
                                        2416942.849571759 "A.D. 1905-Apr-07 08:23:23"\
                                        -4.533225356632436E+00  2.956593657067485E+01 -5.043447238135594E-01\
                                        2419270.121215278 "A.D. 1911-Aug-21 14:54:33"\
                                        -1.158956328570063E+01  2.763664864231293E+01 -3.020677448334573E-01\
                                        2422274.928819444 "A.D. 1919-Nov-12 10:17:30"\
                                        -1.962911259151029E+01  2.275027340159048E+01 -1.625042585060009E-02\
                                        2428739.750625000 "A.D. 1937-Jul-25 06:00:54"\
                                        -2.967955996561702E+01  5.619186124484746E+00  5.680292177286647E-01\
                                        2431227.969537037 "A.D. 1944-May-17 11:16:08"\
                                        -3.017945146440243E+01 -2.108153473335873E+00  7.386599476882856E-01\
                                        2436474.748576389 "A.D. 1958-Sep-28 05:57:57"\
                                        -2.485272697200379E+01 -1.734759783360491E+01  9.297465043737029E-01\
                                        2449680.541712963 "A.D. 1994-Nov-24 01:00:04"\
                                        1.170086885165452E+01 -2.780412359784611E+01  3.029126532636191E-01]
            set data_larr(Pluto) [list 2392618.348888889 "A.D. 1838-Aug-31 20:22:24"\
                                      4.319144305784553E+01  1.491612481909514E+01 -1.408860151406584E+01\
                                      2394577.781967592 "A.D. 1844-Jan-12 06:46:02"\
                                      4.208914675661505E+01  1.906899253477123E+01 -1.421463083089179E+01\
                                      2416010.781122685 "A.D. 1902-Sep-18 06:44:49"\
                                      8.139458967327732E+00  4.529892337608468E+01 -7.204659939676943E+00\
                                      2416942.849571759 "A.D. 1905-Apr-07 08:23:23"\
                                      6.084193794334054E+00  4.531836675452865E+01 -6.612238946992349E+00\
                                      2419270.121215278 "A.D. 1911-Aug-21 14:54:33"\
                                      8.943703894804261E-01  4.484405747678521E+01 -5.060245500927272E+00\
                                      2422274.928819444 "A.D. 1919-Nov-12 10:17:30"\
                                      -5.814289500129426E+00  4.306822713995300E+01 -2.929557774631241E+00\
                                      2428739.750625000 "A.D. 1937-Jul-25 06:00:54"\
                                      -1.924744045916400E+01  3.443772768251456E+01  1.880116854260426E+00\
                                      2431227.969537037 "A.D. 1944-May-17 11:16:08"\
                                      -2.356437278583993E+01  2.928877959235743E+01  3.680080490002464E+00\
                                      2436474.748576389 "A.D. 1958-Sep-28 05:57:57"\
                                      -2.971456967645962E+01  1.529286821506976E+01  6.957499450945309E+00\
                                      2449680.541712963 "A.D. 1994-Nov-24 01:00:04"\
                                      -1.531684998679252E+01 -2.457067041136594E+01  7.059722490422151E+00]
            set p_list $::ssk::planets_list
            foreach pbody $p_list {


            }



            aa_equals "Test4S for '${activity}' w/ 3-point Strict curve matches @ pessimistic" $pessimistic3 $pessimistic
            aa_log "testing acc_fin::pretti_geom_avg_of_curve"
            aa_true "Test5N for Te of ${activity} w/ ${n_points}-point normal curve ${curv_avg_fmt} not less than pre-calced Te ${expected_time}" $test5_p


        }
}

